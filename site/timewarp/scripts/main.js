var getReelForDate=function(e){var t=Q.defer();return $.ajax({type:"GET",url:"https://archive.org/advancedsearch.php",data:{q:"collection:(universal_newsreels) AND identifier:(*"+e+"*)",fl:["description","identifier","title"],sort:"avg_rating+desc",rows:"50",page:"1",output:"json"},dataType:"jsonp",success:function(e){var n=e.response.docs;if(n.length>0){var o=n[Math.floor(Math.random()*n.length)];o.url="https://archive.org/download/"+o.identifier+"/"+o.identifier+"_512kb.mp4",t.resolve(o)}else t.reject("No newsreels found")},error:function(e,n){t.reject(n+" error! "+e.statusText)}}),t.promise},updatePage=function(e){e!==moment().format("MM-DD")&&$(".datepicker").html(e+" <i class='fa fa-chevron-down'></i>"),getReelForDate(e).then(function(e){$(".reel").attr("src",e.url),$(".reel-title").text(e.title),$(".reel-description").text(e.description)})["catch"](function(e){console.error(e),"No newsreels found"===e&&$(".reel-title").text("Nothing found on this date. Warp again!")})};Zepto(function(){var e=moment().format("MM-DD");updatePage(e)}),Zepto(function(e){e(".container").height(e(".tv").height()),e(window).on("resize",function(){window.requestAnimationFrame(function(){e(".container").height(e(".tv").height())})})}),Zepto(function(e){window.setInterval(function(){"..."===e(".dots-animate").text()?e(".dots-animate").text("."):e(".dots-animate").text(e(".dots-animate").text()+".")},500)}),Zepto(function(e){e(".datepicker").click(function(){e(".datepicker-dropdown").toggleClass("hide")})}),Zepto(function(e){e(".datepicker-input#day").attr("placeholder",moment().format("DD")),e(".datepicker-input#month").attr("placeholder",moment().format("MM"))}),Zepto(function(e){e(".datepicker-button").click(function(){var t=e(".datepicker-input#day").val(),n=e(".datepicker-input#month").val();"Invalid Date"!==moment(new Date(2e3,n,t))._d?(e(".datepicker-dropdown").toggleClass("hide"),e(".reel-title").html("Warping through time<span class='dots-animate'></span>"),updatePage(moment(new Date(2e3,n-1,t)).format("MM-DD"))):alert("Not a valid date.")})});